<div id="chat"></div>
<input id="message" type="text" placeholder="Type a message..." />
<button onclick="sendMessage()">Send</button>
<script>
const chatDiv = document.getElementById('chat');
const messageInput = document.getElementById('message');
const roomId = new URLSearchParams(window.location.search).get('id');

// Receive messages via SSE
const eventSource = new EventSource(`/sse-chat.php?room_id=${roomId}`);
eventSource.onmessage = (event) => {
    const data = JSON.parse(event.data);
    chatDiv.innerHTML += `<div><b>${data.sender_type}:</b> ${data.message}</div>`;
};

// Send messages via AJAX
function sendMessage() {
    const message = messageInput.value;
    fetch('/send-chat.php', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ room_id: roomId, message, sender_type: 'client' }),
    });
    messageInput.value = '';
}
</script>
